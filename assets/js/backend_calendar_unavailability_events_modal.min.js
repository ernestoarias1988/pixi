window.BackendCalendarUnavailabilityEventsModal=window.BackendCalendarUnavailabilityEventsModal||{},function(a){"use strict";a.resetUnavailableDialog=function(){var a=$("#manage-unavailable");a.find("#unavailable-id").val("");var e,n=GeneralFunctions.formatDate(new Date,GlobalVariables.dateFormat,!0),t=GeneralFunctions.formatDate((new Date).addHours(1),GlobalVariables.dateFormat,!0);switch(GlobalVariables.dateFormat){case"DMY":e="dd/mm/yy";break;case"MDY":e="mm/dd/yy";break;case"YMD":e="yy/mm/dd"}var r=GlobalVariables.firstWeekday,s=GeneralFunctions.getWeekDayId(r);a.find("#unavailable-start").datetimepicker({dateFormat:e,timeFormat:"regular"===GlobalVariables.timeFormat?"h:mm TT":"HH:mm",dayNames:[EALang.sunday,EALang.monday,EALang.tuesday,EALang.wednesday,EALang.thursday,EALang.friday,EALang.saturday],dayNamesShort:[EALang.sunday.substr(0,3),EALang.monday.substr(0,3),EALang.tuesday.substr(0,3),EALang.wednesday.substr(0,3),EALang.thursday.substr(0,3),EALang.friday.substr(0,3),EALang.saturday.substr(0,3)],dayNamesMin:[EALang.sunday.substr(0,2),EALang.monday.substr(0,2),EALang.tuesday.substr(0,2),EALang.wednesday.substr(0,2),EALang.thursday.substr(0,2),EALang.friday.substr(0,2),EALang.saturday.substr(0,2)],monthNames:[EALang.january,EALang.february,EALang.march,EALang.april,EALang.may,EALang.june,EALang.july,EALang.august,EALang.september,EALang.october,EALang.november,EALang.december],prevText:EALang.previous,nextText:EALang.next,currentText:EALang.now,closeText:EALang.close,timeOnlyTitle:EALang.select_time,timeText:EALang.time,hourText:EALang.hour,minuteText:EALang.minutes,firstDay:s}),a.find("#unavailable-start").val(n),a.find("#unavailable-end").datetimepicker({dateFormat:e,timeFormat:"regular"===GlobalVariables.timeFormat?"h:mm TT":"HH:mm",dayNames:[EALang.sunday,EALang.monday,EALang.tuesday,EALang.wednesday,EALang.thursday,EALang.friday,EALang.saturday],dayNamesShort:[EALang.sunday.substr(0,3),EALang.monday.substr(0,3),EALang.tuesday.substr(0,3),EALang.wednesday.substr(0,3),EALang.thursday.substr(0,3),EALang.friday.substr(0,3),EALang.saturday.substr(0,3)],dayNamesMin:[EALang.sunday.substr(0,2),EALang.monday.substr(0,2),EALang.tuesday.substr(0,2),EALang.wednesday.substr(0,2),EALang.thursday.substr(0,2),EALang.friday.substr(0,2),EALang.saturday.substr(0,2)],monthNames:[EALang.january,EALang.february,EALang.march,EALang.april,EALang.may,EALang.june,EALang.july,EALang.august,EALang.september,EALang.october,EALang.november,EALang.december],prevText:EALang.previous,nextText:EALang.next,currentText:EALang.now,closeText:EALang.close,timeOnlyTitle:EALang.select_time,timeText:EALang.time,hourText:EALang.hour,minuteText:EALang.minutes,firstDay:s}),a.find("#unavailable-end").val(t),a.find("#unavailable-notes").val("")},a.initialize=function(){var a=$("#unavailable-provider");for(var e in GlobalVariables.availableProviders){var n=GlobalVariables.availableProviders[e];a.append(new Option(n.first_name+" "+n.last_name,n.id))}$("#manage-unavailable #save-unavailable").on("click",function(){var a=$("#manage-unavailable");a.find(".modal-message").addClass("d-none"),a.find(".has-error").removeClass("has-error");var e=a.find("#unavailable-start").datetimepicker("getDate");if(e){var n=Date.parse(a.find("#unavailable-end").datetimepicker("getDate"));if(n){if(n<e)return a.find(".modal-message").text(EALang.start_date_before_end_error).addClass("alert-danger").removeClass("d-none"),void a.find("#unavailable-start, #unavailable-end").closest(".form-group").addClass("has-error");var t={start_datetime:e.toString("yyyy-MM-dd HH:mm"),end_datetime:n.toString("yyyy-MM-dd HH:mm"),notes:a.find("#unavailable-notes").val(),id_users_provider:$("#unavailable-provider").val()};""!==a.find("#unavailable-id").val()&&(t.id=a.find("#unavailable-id").val());BackendCalendarApi.saveUnavailable(t,function(){Backend.displayNotification(EALang.unavailable_saved),a.find(".alert").addClass("d-none"),a.modal("hide"),$("#select-filter-item").trigger("change")},null)}else a.find("#unavailable-end").closest(".form-group").addClass("has-error")}else a.find("#unavailable-start").closest(".form-group").addClass("has-error")}),$("#insert-unavailable").on("click",function(){BackendCalendarUnavailabilityEventsModal.resetUnavailableDialog();var a=$("#manage-unavailable"),e=new Date,n=parseInt(e.toString("mm"));0<n&&n<15?e.set({minute:15}):15<n&&n<30?e.set({minute:30}):30<n&&n<45?e.set({minute:45}):e.addHours(1).set({minute:0}),0===$(".calendar-view").length&&a.find("#unavailable-provider").val($("#select-filter-item").val()).closest(".form-group").hide(),a.find("#unavailable-start").val(GeneralFunctions.formatDate(e,GlobalVariables.dateFormat,!0)),a.find("#unavailable-end").val(GeneralFunctions.formatDate(e.addHours(1),GlobalVariables.dateFormat,!0)),a.find(".modal-header h3").text(EALang.new_unavailable_title),a.modal("show")})}}(window.BackendCalendarUnavailabilityEventsModal);